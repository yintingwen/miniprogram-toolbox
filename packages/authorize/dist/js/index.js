const t={};function n(n){Object.assign(t,n)}const e=t=>({...t,message:t.errMsg});async function s(t,n,...s){const i="string"==typeof t?js[t]:t;return new Promise(((t,o)=>{i.call(js,{...n,success:n=>{"ok"===n.errMsg.split(":")[1]?t(n):o(e(n))},fail:t=>o(e(t))},...s)}))}async function i(t){s("hideLoading");const{confirm:n}=await s("showModal",{title:"提示",content:"功能需要开启授权，是否前往设置页开启"});if(!n)return Promise.reject(new Error("model点击取消"));const{authSetting:e}=await s("openSetting");return e[t]?Promise.resolve("授权成功"):Promise.reject(new Error("取消授权"))}async function o(n,e){const o=t[n];if(o){const{authSetting:t}=await s("getSetting",{withSubscriptions:!0});!1===t[o]&&await i(o)}return s(n,e)}export{o as call,e as createFailError,i as getApiScope,s as promiseify,n as registerApiScope};
